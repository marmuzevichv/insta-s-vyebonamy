/*
 * This file was generated by the Gradle 'init' task.
 */
apply plugin: 'java'

// Apply the application plugin to add support for building an application
apply plugin: 'application'

apply plugin: 'project-report'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.apache.poi:poi-ooxml:4.1.2'
    implementation 'org.seleniumhq.selenium:selenium-java:3.141.59'
    implementation 'io.github.bonigarcia:webdrivermanager:4.2.2'
    implementation 'com.github.javafaker:javafaker:1.0.2'
    implementation 'io.cucumber:cucumber-java:6.9.1'
    implementation 'com.aventstack:extentreports:4.0.9'
    implementation 'org.apache.poi:poi:4.1.2'
    testImplementation 'io.cucumber:cucumber-junit:6.9.1'
    testImplementation 'org.testng:testng:7.1.0'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.1'

//    compile 'org.apache.logging.log4j:log4j-core:2.10.0'
//    compile 'org.apache.logging.log4j:log4j-api:2.10.0'
//    compile 'io.cucumber:cucumber-java:3.0.2'
//    compile 'io.cucumber:cucumber-junit:3.0.2'
}

// Define the main class for the application
mainClassName = 'App'

test {
    useJUnit()

    testLogging {
        showStandardStreams = true
    }
}

task getMainDeps(type: Copy) {
    from sourceSets.main.runtimeClasspath
    into 'runtime/'
}

task getTestDeps(type: Copy) {
    from sourceSets.test.runtimeClasspath
    into 'runtime/'
}

configurations {
    cucumberRuntime {
        extendsFrom testRuntime
    }
}

task cucumber() {
    dependsOn assemble, compileTestJava
    doLast {
        javaexec {
            main = "cucumber.api.cli.Main"
            classpath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output
            args = ['--plugin',
                    'pretty',
                    '--plugin',
                    'html:target/cucumber',
                    // '--plugin',
                    // 'cucumber.runtime.formatter.CypherFormatter:target/cucumber/cypher.txt',
                    '--plugin',
                    'json:target/cucumber/cucumber.json',
                    '--plugin', 'cucumber.runtime.formatter.CustomJUnitFormatter:cucumber-junit-report',
                    '--glue',
                    // 'com.uscc.security.authentication.agentcellsite',
                    'com/glue',
                    'resources/feature']
        }
    }
}

task printClasspath() {
    doLast {
        FileCollection fullClasspath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output

        fullClasspath.each({ println it.path })
    }
}

